<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Escalation by Binary Paths</title>
</head><body><b><u><div style="text-align: center"><span style="font-size: 20pt">Escalation by Binary Paths</span></div></u></b><br/>
<br/>
<br/>
<span style="font-size: 15pt">Those escalation path are the most common, in CTF games or labs<br/>
<br/>
To know more about those paths, we can manually check for them<br/>
or use tools like <b>PowerUp:<br/>
</b></span><img src="1.png" /><b><span style="font-size: 15pt"><br/>
</span></b><b><span style="font-size: 15pt"><br/>
</span></b><img src="1 3.png" /><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<span style="font-size: 15pt">Here, with a more manual way:<br/>
The <b>SERVICE_CHANGE_CONFIG</b>&nbsp;means that we can change the configuration!<br/>
</span><br/>
<b><span style="font-size: 15pt">C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wuvc Everyone *<br/>
</span></b><img src="1 2.png" /><br/>
<br/>
<br/>
<span style="font-size: 15pt">(Run accesschk64 on the service found)</span>&nbsp;<br/>
<b><span style="font-size: 15pt">C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wuvc daclsvc</span></b><br/>
<img src="1 4.png" /><br/>
<br/>
<br/>
<span style="font-size: 15pt">We can query for the service configuration:<br/>
</span><span style="font-size: 15pt"><b>sc qc daclsvc</b></span><br/>
<img src="1 5.png" /><br/>
<br/>
<br/>
<span style="font-size: 15pt"><br/>
We have the permission to modify this configuration:<br/>
(The space after binPath is important!!!)<br/>
</span><img src="1 6.png" /><br/>
<br/>
<br/>
<span style="font-size: 15pt">Now, we can start the service and see that added "user" into the Administrator group!!<br/>
</span><span style="font-size: 15pt">(The error is because we changed the path)</span><br/>
<img src="1 7.png" /></body></html>