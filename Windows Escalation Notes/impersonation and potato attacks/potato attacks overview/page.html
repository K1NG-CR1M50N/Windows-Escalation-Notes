<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Potato Attacks Overview</title>
</head><body><b><u><div style="text-align: center"><span style="font-size: 20pt">Potato Attacks Overview</span></div></u></b><br/>
<br/>
<br/>
<a href="https://github.com/ohpe/juicy-potato"><span style="font-size: 15pt"><div style="text-align: center">https://github.com/ohpe/juicy-potato<br/>
</div></span></a><span style="font-size: 15pt"><div style="text-align: center"><br/>
<a href="https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/">https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/<br/>
</a><br/>
<br/>
</div></span><br/>
<span style="font-size: 15pt">The idea behind this vulnerability is simple to describe at a high level:<br/>
&nbsp;<ul><li>&nbsp;Trick the “NT AUTHORITY\SYSTEM” account into authenticating via NTLM to a TCP endpoint we control.</li>
</ul>
<ul><li>Man-in-the-middle this authentication attempt (NTLM relay) to locally negotiate a security token for the “NT AUTHORITY\SYSTEM” account. This is done through a series of Windows API calls.</li>
</ul>
<ul><li>Impersonate the token we have just negotiated. This can only be done if the attackers current account has the privilege to impersonate security tokens. This is usually true of most service accounts and not true of most user-level accounts.</li>
</ul>
&nbsp;<br/>
</span><img src="1.png" /></body></html>